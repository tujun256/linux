/dts-v1/;
#include "rk3588.dtsi"
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/clock/rk3588-cru.h>
#include <dt-bindings/power/rk3588-power.h>

/ {
	model = "HiteVision HL-ZF9000";
	compatible = "hitevision,hl-zf9000", "rockchip,rk3588";
	interrupt-parent = <&gic>;
	#address-cells = <2>;
	#size-cells = <2>;

	aliases {
		gpio0 = &gpio0;
		gpio1 = &gpio1;
		gpio2 = &gpio2;
		gpio3 = &gpio3;
		gpio4 = &gpio4;
		ethernet0 = &gmac0;
		ethernet1 = &gmac1;
		serial0 = &uart2;
		hdmi-in = &lt6911uxc;
		hdmi-out = &hdmi0;
	};

	chosen {
		stdout-path = "serial2:115200n8";
	};

	clocks {
		clk_gmac0_ref: clk-gmac0-ref {
			compatible = "fixed-clock";
			clock-frequency = <125000000>;
			clock-output-names = "clk_gmac0_ref";
		};
		clk_gmac1_ref: clk-gmac1-ref {
			compatible = "fixed-clock";
			clock-frequency = <125000000>;
			clock-output-names = "clk_gmac1_ref";
		};
	};

	regulators {
		vcc5v0_usb3: vcc5v0-usb3-regulator {
			compatible = "regulator-fixed";
			regulator-name = "vcc5v0_usb3";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			gpio = <&gpio4 24 0>; /* gpio-152 */
			enable-active-high;
		};

		vcc3v3_lt6911: vcc3v3-lt6911-regulator {
			compatible = "regulator-fixed";
			regulator-name = "vcc3v3_lt6911";
			regulator-min-microvolt = <3300000>;
			regulator-max-microvolt = <3300000>;
			gpio = <&gpio1 12 0>; /* gpio-44 */
			enable-active-high;
		};

		vcc3v3_ops: vcc3v3-ops-regulator {
			compatible = "regulator-fixed";
			regulator-name = "vcc3v3_ops";
			regulator-min-microvolt = <3300000>;
			regulator-max-microvolt = <3300000>;
			gpio = <&gpio1 20 0>; /* gpio-52 */
			enable-active-high;
		};

		vcc5v0_sata: vcc5v0-sata-regulator {
			compatible = "regulator-fixed";
			regulator-name = "vcc5v0_sata";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			gpio = <&gpio3 13 0>; /* gpio-109 */
			enable-active-high;
		};
	};

	sound {
		compatible = "simple-audio-card";
		simple-audio-card,name = "es8316-audio";
		simple-audio-card,format = "i2s";
		simple-audio-card,bitclock-master = <&codec_dai>;
		simple-audio-card,frame-master = <&codec_dai>;

		simple-audio-card,cpu {
			sound-dai = <&i2s2>;
		};

		codec_dai: simple-audio-card,codec {
			sound-dai = <&es8316>;
		};
	};
};

&gmac0 {
	status = "okay";
	compatible = "rockchip,rk3588-gmac", "snps,dwmac-4.20a";
	reg = <0x0 0xfe1b0000 0x0 0x10000>;
	interrupts = <GIC_SPI 233 IRQ_TYPE_LEVEL_HIGH>,
		     <GIC_SPI 234 IRQ_TYPE_LEVEL_HIGH>;
	interrupt-names = "macirq", "eth_wake_irq";
	rockchip,grf = <&sys_grf>;
	rockchip,php_grf = <&php_grf>;
	clocks = <&cru SCLK_GMAC0>, <&cru SCLK_GMAC0_RX>,
		 <&cru SCLK_GMAC0_TX>, <&clk_gmac0_ref>,
		 <&cru ACLK_GMAC0>;
	clock-names = "stmmaceth", "clk_mac_ref", "clk_mac_ref",
		      "clk_gmac_ref", "aclk_mac";
	resets = <&cru RST_GMAC0>;
	reset-names = "stmmaceth";
	power-domains = <&power RK3588_PD_GMAC>;

	snps,mixed-burst;
	snps,tso;
	snps,axi-config = <&gmac0_axi_config>;
	phy-mode = "rgmii-id";
	phy-handle = <&phy0>;
	phy-reset-gpios = <&gpio1 11 GPIO_ACTIVE_LOW>; /* gpio-43 */
	phy-reset-duration = <200>;

	mdio {
		#address-cells = <1>;
		#size-cells = <0>;

		phy0: ethernet-phy@0 {
			reg = <0x0>;
			compatible = "realtek,rtl8111h", "ethernet-phy-ieee802.3-c22";
			realtek,clkout-disable;
		};
	};

	gmac0_axi_config: stmmac-axi-config {
		snps,wr_osr_lmt = <0x4>;
		snps,rd_osr_lmt = <0x8>;
		snps,blen = <0 0 0 0 16 8 4>;
	};
};

&gmac1 {
	status = "okay";
	compatible = "rockchip,rk3588-gmac", "snps,dwmac-4.20a";
	reg = <0x0 0xfe1c0000 0x0 0x10000>;
	interrupts = <GIC_SPI 235 IRQ_TYPE_LEVEL_HIGH>,
		     <GIC_SPI 236 IRQ_TYPE_LEVEL_HIGH>;
	interrupt-names = "macirq", "eth_wake_irq";
	rockchip,grf = <&sys_grf>;
	rockchip,php_grf = <&php_grf>;
	clocks = <&cru SCLK_GMAC1>, <&cru SCLK_GMAC1_RX>,
		 <&cru SCLK_GMAC1_TX>, <&clk_gmac1_ref>,
		 <&cru ACLK_GMAC1>;
	clock-names = "stmmaceth", "clk_mac_ref", "clk_mac_ref",
		      "clk_gmac_ref", "aclk_mac";
	resets = <&cru RST_GMAC1>;
	reset-names = "stmmaceth";
	power-domains = <&power RK3588_PD_GMAC>;

	snps,mixed-burst;
	snps,tso;
	snps,axi-config = <&gmac1_axi_config>;
	phy-mode = "rgmii-id";
	phy-handle = <&phy1>;
	phy-reset-gpios = <&gpio1 10 GPIO_ACTIVE_LOW>;
	phy-reset-duration = <200>;

	mdio {
		#address-cells = <1>;
		#size-cells = <0>;

		phy1: ethernet-phy@1 {
			reg = <0x1>;
			compatible = "realtek,rtl8111h", "ethernet-phy-ieee802.3-c22";
			realtek,clkout-disable;
		};
	};

	gmac1_axi_config: stmmac-axi-config {
		snps,wr_osr_lmt = <0x4>;
		snps,rd_osr_lmt = <0x8>;
		snps,blen = <0 0 0 0 16 8 4>;
	};
};

&usbhost3_0 {
	status = "okay";
	compatible = "rockchip,rk3588-dwc3", "rockchip,rk3399-dwc3";
	clocks = <&cru SCLK_USB3_HOST0_REF>, <&cru SCLK_USB3_HOST0_SUSPEND>,
		 <&cru ACLK_USB3_HOST0>, <&cru SCLK_USB3_HOST0_UTMI>,
		 <&cru SCLK_USB3_HOST0_PHP>, <&cru SCLK_USB3_HOST0_PIPE>;
	clock-names = "ref", "suspend", "bus", "utmi", "php", "pipe";
	#address-cells = <2>;
	#size-cells = <2>;
	ranges;

	usb@fcd00000 {
		compatible = "snps,dwc3";
		reg = <0x0 0xfcd00000 0x0 0x400000>;
		interrupts = <GIC_SPI 222 IRQ_TYPE_LEVEL_HIGH>;
		resets = <&cru RST_USB3_HOST0>;
		reset-names = "usb3-host";
		dr_mode = "host";
		phys = <&usb3_phy0>;
		phy-names = "usb3-phy";
		phy_type = "utmi_wide";
		vbus-supply = <&vcc5v0_usb3>;
		snps,dis_enblslpm_quirk;
		snps,dis-u2-freeclk-exists-quirk;
	};
};

&usbdrd3_0 {
	status = "okay";
	compatible = "rockchip,rk3588-dwc3", "rockchip,rk3399-dwc3";
	clocks = <&cru SCLK_USB3_OTG_REF>, <&cru SCLK_USB3_OTG_SUSPEND>,
		 <&cru ACLK_USB3_OTG>;
	clock-names = "ref", "suspend", "bus";
	#address-cells = <2>;
	#size-cells = <2>;
	ranges;

	usb@fc000000 {
		compatible = "snps,dwc3";
		reg = <0x0 0xfc000000 0x0 0x400000>;
		interrupts = <GIC_SPI 220 IRQ_TYPE_LEVEL_HIGH>;
		power-domains = <&power RK3588_PD_USB>;
		resets = <&cru RST_USB3_OTG>;
		reset-names = "usb3-otg";
		dr_mode = "otg";
		phys = <&usb2_phy0>, <&usb3_phy0>;
		phy-names = "usb2-phy", "usb3-phy";
		phy_type = "utmi_wide";
		otg-switch-gpios = <&gpio0 15 GPIO_ACTIVE_LOW>; /* gpio-15 */
		extcon = <&usb2_phy0>;
		vbus-supply = <&vcc5v0_usb3>;
	};
};

&usb2_phy0 {
	status = "okay";
	vbus-supply = <&vcc5v0_usb3>;
	otg-port {
		#phy-cells = <0>;
		status = "okay";
		vbus-supply = <&vcc5v0_usb3>;
	};
};

&usb3_phy0 {
	status = "okay";
};

&i2c4 {
	status = "okay";
	lt6911uxc: hdmi-receiver@2b {
		compatible = "lontium,lt6911uxc";
		reg = <0x2b>;
		status = "okay";
		clocks = <&cru SCLK_HDMI_IN_XVCLK>;
		clock-names = "xvclk";
		power-supply = <&vcc3v3_lt6911>;
		reset-gpios = <&gpio1 13 GPIO_ACTIVE_LOW>;
		plugin-det-gpios = <&gpio4 28 0>; /* gpio-156 */
		interrupt-parent = <&gpio1>;
		interrupts = <3 IRQ_TYPE_LEVEL_HIGH>;

		port {
			lt6911uxc_out: endpoint {
				remote-endpoint = <&mipi2_csi2_in>;
				data-lanes = <1 2 3 4>;
			};
		};
	};
};

&mipi2_csi2 {
	status = "okay";
	ports {
		port@0 {
			reg = <0>;
			mipi2_csi2_in: endpoint@1 {
				reg = <1>;
				remote-endpoint = <&lt6911uxc_out>;
			};
		};
		port@1 {
			reg = <1>;
			endpoint@0 {
				reg = <0>;
				remote-endpoint = <&rkcif_mipi_lvds2_in>;
			};
		};
	};
};

&rkcif_mipi_lvds2 {
	status = "okay";
	port {
		rkcif_mipi_lvds2_in: endpoint {
			remote-endpoint = <&mipi2_csi2_out>;
		};
	};
};

&hdmi0 {
	status = "okay";
	compatible = "rockchip,rk3588-dw-hdmi";
	reg = <0x0 0xfde80000 0x0 0x20000>;
	interrupts = <GIC_SPI 169 IRQ_TYPE_LEVEL_HIGH>,
		     <GIC_SPI 170 IRQ_TYPE_LEVEL_HIGH>,
		     <GIC_SPI 171 IRQ_TYPE_LEVEL_HIGH>,
		     <GIC_SPI 172 IRQ_TYPE_LEVEL_HIGH>,
		     <GIC_SPI 360 IRQ_TYPE_LEVEL_HIGH>;
	clocks = <&cru PCLK_HDMI0>, <&cru SCLK_HDMI0_HPD>,
		 <&cru SCLK_HDMI0_EARC>, <&cru SCLK_HDMI0_TX_REF>,
		 <&i2s2>, <&cru DCLK_VP0>, <&cru DCLK_VP1>,
		 <&cru DCLK_VP2>, <&cru DCLK_VP3>, <&hclk_vo1>,
		 <&hdmi0_link_clk>;
	clock-names = "pclk", "hpd", "earc", "hdmitx_ref", "aud",
		      "dclk_vp0", "dclk_vp1", "dclk_vp2", "dclk_vp3",
		      "hclk_vo1", "link_clk";
	resets = <&cru RST_HDMI0_REF>, <&cru RST_HDMI0_HDP>;
	reset-names = "ref", "hdp";
	power-domains = <&power RK3588_PD_HDMI0>;
	pinctrl-names = "default";
	pinctrl-0 = <&hdmi0_pins>;
	reg-io-width = <4>;
	rockchip,grf = <&sys_grf>;
	rockchip,vo1_grf = <&vo1_grf>;
	phys = <&hdmi0_phy>;
	phy-names = "hdmi";
	#sound-dai-cells = <0>;

	ports {
		port@0 {
			reg = <0>;
			endpoint@0 {
				reg = <0>;
				remote-endpoint = <&vp0_out_hdmi0>;
				status = "okay";
			};
		};
	};
};

&hdmi0_phy {
	status = "okay";
};

&vp0 {
	status = "okay";
	port {
		vp0_out_hdmi0: endpoint {
			remote-endpoint = <&hdmi0_in>;
		};
	};
};

&pcie1 {
	status = "okay";
	compatible = "rockchip,rk3588-pcie", "snps,dw-pcie";
	#address-cells = <3>;
	#size-cells = <2>;
	bus-range = <0x40 0x4f>;
	clocks = <&cru ACLK_PCIE1_MST>, <&cru ACLK_PCIE1_SLV>,
		 <&cru ACLK_PCIE1_DBI>, <&cru PCLK_PCIE1>,
		 <&cru SCLK_PCIE1_AUX>, <&cru SCLK_PCIE1_PIPE>;
	clock-names = "aclk_mst", "aclk_slv", "aclk_dbi", "pclk",
		      "aux", "pipe";
	device_type = "pci";
	interrupts = <GIC_SPI 253 IRQ_TYPE_LEVEL_HIGH>,
		     <GIC_SPI 252 IRQ_TYPE_LEVEL_HIGH>,
		     <GIC_SPI 251 IRQ_TYPE_LEVEL_HIGH>,
		     <GIC_SPI 250 IRQ_TYPE_LEVEL_HIGH>,
		     <GIC_SPI 249 IRQ_TYPE_LEVEL_HIGH>;
	interrupt-names = "sys", "pmc", "msg", "legacy", "err";
	#interrupt-cells = <1>;
	interrupt-map-mask = <0 0 0 7>;
	interrupt-map = <0 0 0 1 &pcie1_intc 0>,
			<0 0 0 2 &pcie1_intc 1>,
			<0 0 0 3 &pcie1_intc 2>,
			<0 0 0 4 &pcie1_intc 3>;
	linux,pci-domain = <0x4>;
	num-ib-windows = <8>;
	num-ob-windows = <8>;
	num-viewport = <4>;
	max-link-speed = <2>;
	msi-map = <0x4000 &its 0x4000 0x1000>;
	num-lanes = <1>;
	phys = <&combphy1 0x2>;
	phy-names = "pcie-phy";
	ranges = <0x800 0x0 0xf4000000 0x0 0xf4000000 0x0 0x100000>,
		 <0x81000000 0x0 0xf4100000 0x0 0xf4100000 0x0 0x100000>,
		 <0x82000000 0x0 0xf4200000 0x0 0xf4200000 0x0 0xe00000>,
		 <0xc3000000 0x9 0x0 0x9 0x0 0x0 0x40000000>;
	reg = <0x0 0xfe190000 0x0 0x10000>,
	      <0x9 0x41000000 0x0 0x400000>;
	reg-names = "pcie-apb", "pcie-dbi";
	resets = <&cru RST_PCIE1>, <&cru RST_PCIE1_PERIPH>;
	reset-names = "pcie", "periph";
	rockchip,pipe-grf = <&pipe_grf>;
	power-supply = <&vcc3v3_ops>;
	reset-gpios = <&gpio1 21 GPIO_ACTIVE_LOW>;

	pcie1_intc: legacy-interrupt-controller {
		interrupt-controller;
		#address-cells = <0>;
		#interrupt-cells = <1>;
		interrupt-parent = <&gic>;
		interrupts = <GIC_SPI 250 IRQ_TYPE_LEVEL_HIGH>;
	};
};

&combphy1 {
	status = "okay";
	compatible = "rockchip,rk3588-naneng-combphy";
	reg = <0x0 0xfee20000 0x0 0x100>;
	#phy-cells = <1>;
	clocks = <&cru SCLK_COMBPHY1_REF>, <&cru ACLK_COMBPHY1_APB>,
		 <&cru PCLK_PHP>;
	clock-names = "refclk", "apbclk", "phpclk";
	assigned-clocks = <&cru SCLK_COMBPHY1_REF>;
	assigned-clock-rates = <100000000>;
	resets = <&cru RST_COMBPHY1_APB>, <&cru RST_COMBPHY1>;
	reset-names = "combphy-apb", "combphy";
	rockchip,pipe-grf = <&pipe_grf>;
	rockchip,pipe-phy-grf = <&pipe_phy_grf1>;
};

&uart2 {
	status = "okay";
	compatible = "rockchip,rk3588-uart", "snps,dw-apb-uart";
	reg = <0x0 0xfeb50000 0x0 0x100>;
	interrupts = <GIC_SPI 333 IRQ_TYPE_LEVEL_HIGH>;
	clocks = <&cru SCLK_UART2>, <&cru PCLK_UART2>;
	clock-names = "baudclk", "apb_pclk";
	reg-shift = <2>;
	reg-io-width = <4>;
	dmas = <&dma0 10 0>, <&dma0 11 0>;
	dma-names = "tx", "rx";
	pinctrl-names = "default";
	pinctrl-0 = <&uart2_m0_xfer>;
	uart-has-rtscts;
};

&i2c3 {
	status = "okay";
	es8316: audio-codec@10 {
		status = "okay";
		compatible = "everest,es8316";
		reg = <0x10>;
		clocks = <&cru SCLK_I2S2_MCLK>;
		clock-names = "mclk";
		assigned-clocks = <&cru SCLK_I2S2_MCLK>;
		assigned-clock-rates = <11289600>;
		pinctrl-names = "default";
		pinctrl-0 = <&i2s2_mclk>;
		hp-det-gpios = <&gpio1 29 GPIO_ACTIVE_LOW>; /* gpio-61 */

		port {
			es8316_in: endpoint {
				remote-endpoint = <&i2s2_out>;
			};
		};
	};
};

&i2s2 {
	status = "okay";
	compatible = "rockchip,rk3588-i2s-tdm";
	reg = <0x0 0xfddf0000 0x0 0x1000>;
	interrupts = <GIC_SPI 185 IRQ_TYPE_LEVEL_HIGH>;
	clocks = <&cru SCLK_I2S2_TX_MCLK>, <&cru SCLK_I2S2_RX_MCLK>,
		 <&cru PCLK_I2S2>;
	clock-names = "mclk_tx", "mclk_rx", "hclk";
	assigned-clocks = <&cru SCLK_I2S2_TX_MCLK>;
	assigned-clock-parents = <&cru CLK_PLL_AUDIO>;
	dmas = <&dma1 2 0>;
	dma-names = "tx";
	power-domains = <&power RK3588_PD_AUDIO>;
	resets = <&cru RST_I2S2_TX>;
	reset-names = "tx-m";
	rockchip,always-on;
	rockchip,hdmi-path;
	rockchip,playback-only;
	#sound-dai-cells = <0>;

	port {
		i2s2_out: endpoint {
			remote-endpoint = <&es8316_in>;
		};
	};
};

&sata0 {
	status = "okay";
	compatible = "rockchip,rk-ahci", "snps,dwc-ahci";
	reg = <0x0 0xfe210000 0x0 0x1000>;
	interrupts = <GIC_SPI 240 IRQ_TYPE_LEVEL_HIGH>;
	clocks = <&cru ACLK_SATA>, <&cru SCLK_SATA_REF>,
		 <&cru SCLK_SATA_PHY>;
	clock-names = "aclk", "sclk_ref", "sclk_phy";
	resets = <&cru RST_SATA_AXI>, <&cru RST_SATA_PHY>,
		 <&cru RST_SATA>;
	reset-names = "axi", "phy", "controller";
	power-domains = <&power RK3588_PD_SATA>;
	phys = <&sata_phy>;
	phy-names = "sata-phy";
	vbus-supply = <&vcc5v0_sata>;
};

&sata_phy {
	status = "okay";
	compatible = "rockchip,rk3588-sata-phy";
	reg = <0x0 0xfe220000 0x0 0x1000>;
	clocks = <&cru SCLK_SATA_PHY>, <&cru SCLK_SATA_REF>;
	clock-names = "phy", "ref";
	resets = <&cru RST_SATA_PHY>;
	reset-names = "phy";
	rockchip,phy-type = "sata";
};

&sdhci {
	status = "okay";
	bus-width = <8>;
	max-frequency = <200000000>;
	non-removable;
	cap-mmc-highspeed;
	mmc-ddr-1_8v;
	mmc-hs200-1_8v;
	vmmc-supply = <&vcc_3v3>;
	vqmmc-supply = <&vccio_sd>;
	pinctrl-names = "default";
	pinctrl-0 = <&emmc_bus8 &emmc_clk &emmc_cmd>;
};

&rk806 {
	status = "okay";
	reg = <0x1b>;
	interrupt-parent = <&gpio0>;
	interrupts = <12 IRQ_TYPE_LEVEL_LOW>;
	pinctrl-names = "default";
	pinctrl-0 = <&pmic_int_l>;
};
